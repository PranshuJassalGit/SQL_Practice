Question: https://datalemur.com/questions/final-account-balance

Solution:

SELECT account_id ,(sum( case when transaction_type = 'Deposit' then amount else 0 end) - sum( case when transaction_type = 'Withdrawal' then amount else 0 end) ) as Final_balance
FROM transactions
GROUP by account_id